# 持续生成系统说明

## 概述
将原有的波次系统改为持续生成系统，僵尸源源不断地出现，不再有波次间隔。

## 主要改动

### 1. 移除波次系统
- ❌ 旧系统：每波固定数量的僵尸，打完等待5秒开始下一波
- ✅ 新系统：僵尸持续不断地慢慢出现，无需等待

### 2. 动态难度调整
**基于分数的难度等级**：
- 每获得10,000分，难度等级+1
- 难度等级越高，同时存在的僵尸数量越多
- 恶魔出现概率随难度等级提升

**动态僵尸数量计算**：
```
基础数量 = 15只
难度加成 = 难度等级 × 3
玩家加成 = (玩家数-1) × 5
最终数量 = (基础 + 难度加成 + 玩家加成) × 难度系数
```

示例：
- 0分（等级0），单人，中等难度：15只同时在场
- 10,000分（等级1），单人，中等难度：18只同时在场
- 50,000分（等级5），双人，中等难度：35只同时在场

### 3. 智能生成速率
**自适应生成**：
- 当前僵尸数量 < 最大值时，持续生成
- 僵尸越少，生成速度越快
- 僵尸接近最大值时，生成速度减慢

**生成速率公式**：
```
敌人比例 = 当前数量 / 最大数量
基础速率 = 2% (每帧)
加速速率 = 8% × (1 - 敌人比例)
最终速率 = (基础 + 加速) × 难度系数
```

### 4. 恶魔生成概率
- 基础概率：10%
- 每个难度等级增加：4%
- 最高概率：50%
- 难度系数调整：根据用户选择的难度（简单/中等/困难）

### 5. 道具掉落调整
**安全屋道具**：
- 旧系统：每波只掉落1个
- 新系统：每个恶魔有15%概率掉落（可以多次获得）

**血包**：
- 每个恶魔必掉血包（不变）

**弹药**：
- 随机掉落给所有玩家（不变）

## 游戏体验改进

### 优点
1. ✅ **持续紧张感**：不再有打完一波的"安全时间"
2. ✅ **流畅体验**：无需等待倒计时，游戏节奏更快
3. ✅ **动态难度**：随着玩家实力提升，挑战也随之增加
4. ✅ **灵活策略**：玩家可以选择主动清场或边战边守

### 平衡性
- 僵尸数量有上限，不会无限增加导致卡顿
- 生成速率自适应，玩家有喘息机会
- 难度递增缓慢，不会突然暴增

## 技术实现

### 修改的文件
1. `components/game/updateSystem.ts`
   - 移除波次倒计时逻辑
   - 实现持续生成算法
   - 调整恶魔生成概率计算

2. `components/game/physicsSystem.ts`
   - 修改安全屋道具掉落逻辑（移除"每波一次"限制）

### 保留的功能
- 难度等级提升提示（"警告：敌人大量涌现！"）
- 玩家复活系统
- 装备和道具系统
- 寻路AI系统
- 所有原有的游戏机制

## 游戏结束画面
游戏结束画面已完全中文化，包括：
- 标题："游戏结束"
- 副标题："行动报告"
- 分数标签："最终得分"
- 按钮："重新开始"、"设置"、"返回主菜单"

